library(tidyverse)
library(tidymodels)
acquisitions <- read_csv("data/acquisitions.csv")
all_cetaceans <- read_csv("data/allCetaceanData.csv")
survival_rates <- read_csv("data/survivalRates.csv")
all_cetaceans2 <- all_cetaceans %>%
transform(deathyear = as.numeric(substr(statusDate, 1, 4))) %>%
mutate(longevity = deathyear - birthYear) %>%
rename(transferdate = transferDate) %>%
rename(transfertype = transfer) %>%
rename(deathlocation = currently) %>%
mutate(transfer = ifelse(transfers == "NA", "0", "1")) %>%
mutate(originyear = as.numeric(substr(originDate, 1, 4))) %>%
mutate(captivity = (deathyear - originyear) / longevity) %>%
subset(select = -c(id, name, mother, father, region, COD, ...1, entryDate,
notes))
all_cetaceans2["transfer"][is.na(all_cetaceans2["transfer"])] <- 0
colnames(all_cetaceans2)
cetacean_deaths <- all_cetaceans2[, c(1, 2, 3, 4, 6, 18, 7, 5, 9, 10, 11,
15, 16, 19, 17, 8, 13, 14, 12)]
View(all_cetaceans2)
all_cetaceans2 <- all_cetaceans %>%
transform(deathyear = as.numeric(substr(statusDate, 1, 4))) %>%
mutate(longevity = deathyear - birthYear) %>%
rename(transferdate = transferDate) %>%
rename(transfertype = transfer) %>%
rename(deathlocation = currently) %>%
mutate(transfer = ifelse(transfers == "NA", "0", "1")) %>%
mutate(originyear = as.numeric(substr(originDate, 1, 4))) %>%
mutate(captivity = (deathyear - originyear) / longevity) %>%
subset(select = -c(id, name, mother, father, region, COD, ...1, entryDate,
notes))
all_cetaceans2["transfer"][is.na(all_cetaceans2["transfer"])] <- 0
colnames(all_cetaceans2)
head(cetacean_deaths)
all_cetaceans2 <- all_cetaceans %>%
transform(deathyear = as.numeric(substr(statusDate, 1, 4))) %>%
mutate(longevity = deathyear - birthYear) %>%
rename(transferdate = transferDate) %>%
rename(transfertype = transfer) %>%
rename(deathlocation = currently) %>%
mutate(transfer = ifelse(transfers == "NA", "0", "1")) %>%
mutate(originyear = as.numeric(substr(originDate, 1, 4))) %>%
mutate(captivity = (deathyear - originyear) / longevity) %>%
subset(select = -c(id, name, mother, father, region, COD, ...1, entryDate,
notes))
all_cetaceans2["transfer"][is.na(all_cetaceans2["transfer"])] <- 0
colnames(all_cetaceans2)
head(all_cetaceans2)
library(tidyverse)
library(tidymodels)
acquisitions <- read_csv("data/acquisitions.csv")
all_cetaceans <- read_csv("data/allCetaceanData.csv")
survival_rates <- read_csv("data/survivalRates.csv")
all_cetaceans2 <- all_cetaceans %>%
transform(deathyear = as.numeric(substr(statusDate, 1, 4))) %>%
mutate(longevity = deathyear - birthYear) %>%
rename(transferdate = transferDate) %>%
rename(transfertype = transfer) %>%
rename(deathlocation = currently) %>%
mutate(transfer = ifelse(transfers == "NA", "0", "1")) %>%
mutate(originyear = as.numeric(substr(originDate, 1, 4))) %>%
mutate(captivity = (deathyear - originyear) / longevity) %>%
subset(select = -c(id, name, mother, father, region, COD, ...1, entryDate,
notes))
all_cetaceans2["transfer"][is.na(all_cetaceans2["transfer"])] <- 0
colnames(all_cetaceans2)
head(all_cetaceans2)
library(tidyverse)
library(tidymodels)
library(survival)
acquisitions <- read_csv("data/acquisitions.csv")
all_cetaceans <- read_csv("data/allCetaceanData.csv")
survival_rates <- read_csv("data/survivalRates.csv")
all_cetaceans$statusDate <- as.character(all_cetaceans$statusDate)
class(all_cetaceans$statusDate)
all_cetaceans2 <- all_cetaceans %>%
mutate(statusDate2 = ifelse(status == "Alive", "2017-05-07", all_cetaceans$statusDate)) %>%
transform(statusyear = as.numeric(substr(statusDate2, 1, 4))) %>%
mutate(bottlenose = ifelse(species == "Bottlenose", 1, 0)) %>%
mutate(age = statusyear - birthYear) %>%
rename(transferdate = transferDate) %>%
rename(transfertype = transfer) %>%
rename(currentlocation = currently) %>%
mutate(originyear = as.numeric(substr(originDate, 1, 4))) %>%
mutate(captivity = (statusyear - originyear) / age) %>%
subset(select = -c(id, name, mother, father, region, COD, ...1, entryDate,
notes)) %>%
mutate(status2 = case_when(status %in% c("Miscarriage", "Escaped (Found Dead)",
"Died", "Stillbirth") ~ 1,
status %in% c("Escaped", "Released", "Released?",
"Unknown", "Alive") ~ 0))
